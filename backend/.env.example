# =============================================================================
# Electricity Optimizer Backend - Environment Configuration
# =============================================================================
# Copy this file to .env and fill in your values
# All database/API fields are optional for local dev (endpoints return simulated data)

# Application
ENVIRONMENT=development
DEBUG=false
BACKEND_PORT=8000

# Database - Neon PostgreSQL (optional for dev)
# DATABASE_URL takes priority over TIMESCALEDB_URL
# DATABASE_URL=postgresql://user:password@host.neon.tech/dbname?sslmode=require
# TIMESCALEDB_URL=postgresql://postgres:password@localhost:5432/electricity_optimizer

# Redis (Upstash) — required for rate limiting, caching, ensemble weights
# Retrieve from 1Password: op item get "Redis Upstash" --vault "dd"
REDIS_URL=rediss://default:PASSWORD@HOST.upstash.io:6379
REDIS_PASSWORD=

# Authentication — Neon Auth (Better Auth)
# BETTER_AUTH_SECRET: Signing key for session tokens (generate with: openssl rand -hex 32)
# BETTER_AUTH_URL: Public URL of the frontend (e.g. https://your-app.onrender.com)
# BETTER_AUTH_SECRET=your-better-auth-secret-here
# BETTER_AUTH_URL=http://localhost:3000

# JWT (used only for internal API key validation, NOT user auth)
# IMPORTANT: In production, JWT_SECRET must be at least 32 characters and unique.
# JWT_SECRET=  # REQUIRED: Generate with: openssl rand -hex 32
JWT_ALGORITHM=HS256
JWT_EXPIRATION_HOURS=24

# Service-to-service API key (must NOT be the same as JWT_SECRET)
# Generate with: openssl rand -hex 32
INTERNAL_API_KEY=your-separate-api-key-here

# OAuth Providers (optional — social login is disabled when these are absent)
# GOOGLE_CLIENT_ID=your-google-client-id
# GOOGLE_CLIENT_SECRET=your-google-client-secret
# GITHUB_CLIENT_ID=your-github-client-id
# GITHUB_CLIENT_SECRET=your-github-client-secret

# External APIs (optional for dev)
# FLATPEAK_API_KEY=fp_xxx
# NREL_API_KEY=nrel_xxx
# IEA_API_KEY=iea_xxx
# OPENWEATHERMAP_API_KEY=owm_xxx  # Free tier: 1000 calls/day

# Stripe (for monetization)
# STRIPE_SECRET_KEY=sk_test_xxx
# STRIPE_WEBHOOK_SECRET=whsec_xxx
# STRIPE_PRICE_PRO=price_xxx       # Pro tier price ID from Stripe dashboard
# STRIPE_PRICE_BUSINESS=price_xxx   # Business tier price ID from Stripe dashboard

# Email (optional - SendGrid primary, SMTP fallback)
# SENDGRID_API_KEY=SG.xxx

# CORS - explicit origin allowlist (JSON array for pydantic-settings 2.x)
# In production, set this to your actual frontend domains (no regex).
# CORS_ORIGINS=["http://localhost:3000","https://electricity-optimizer.vercel.app"]

# Rate Limiting
RATE_LIMIT_PER_MINUTE=100
RATE_LIMIT_PER_HOUR=1000

# GDPR/Compliance
DATA_RETENTION_DAYS=730
CONSENT_REQUIRED=true
DATA_RESIDENCY=US

# ML Model Configuration
MODEL_FORECAST_HOURS=24
MODEL_RETRAIN_INTERVAL_DAYS=7
MODEL_ACCURACY_THRESHOLD_MAPE=10.0

# Field-level encryption (AES-256-GCM) for user account numbers
# Generate: python -c "import secrets; print(secrets.token_hex(32))"
FIELD_ENCRYPTION_KEY=your-64-hex-char-key-here

# GitHub Webhook (HMAC-SHA256 signature verification)
# Generate: python -c "import secrets; print(secrets.token_hex(32))"
# GITHUB_WEBHOOK_SECRET=your-64-hex-char-secret-here

# Feature Flags
ENABLE_AUTO_SWITCHING=false
ENABLE_LOAD_OPTIMIZATION=true
ENABLE_REAL_TIME_UPDATES=true

# Monitoring (optional)
# SENTRY_DSN=https://examplePublicKey@o0.ingest.sentry.io/0
PROMETHEUS_PORT=9090
